# 多线程与界面组件的通信

- 有趣的问题
    是否可以在子线程中创建界面组件？
    ```c
    class TestThread : public QThread
    {
        Q_OBJECT
    protected:
        void run()
        {
            QWidget w; /* attempt to create UI element */

            w.show();

            exec();
        }
    };
    ```

# 编程实验 子线程中创建界面组件

- GUI系统设计原则
    所有界面组件的操作都只能在主线程中完成；因此，主线程也叫做UI线程！

- 思考
    子线程如何对界面组件进行更新？

- 解决方案 - 信号与槽
    1. 在子线程类中定义界面组件的更新信号（updateUI)
    2. 在主窗口类中定义更新界面组件的槽函数（setlnfo )
    3. 使用异步方式街妾更新信号到槽函数（updateUI今setlnfo )
        - 子线程通过发射信号的方式更新界面组件
        - 所有的界面组件对象只能依附于主线程

    ![](_v_images_/.png)
    子线程不能直接操作界面组件，但是可以通过信号与槽的机制间接操作界面组件。

# 编程实验 子线程中更新界面组件

# 小结
- 现代GUI平台只允许在主线程中直接操作界面组件
- Qt中可以借助信号与槽的机制在子线程中操作界面组件
- 进行信号与槽的连接时必须采用异步连接的方式
- 界面组件对象必须依附于主线程
